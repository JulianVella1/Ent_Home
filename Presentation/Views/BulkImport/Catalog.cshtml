@model List<Common.Interfaces.IItemValidating>

<h2>Catalog</h2>

@if (TempData["Message"] != null)
{
    <div class="alert alert-info">@TempData["Message"]</div>
}

<!-- Upload -->
<form asp-controller="BulkImport" asp-action="BulkImport" method="post" enctype="multipart/form-data" class="mb-3">
    <input class="form-control" type="file" name="file" accept=".json" />
    <button class="btn btn-primary mt-2" type="submit">Upload JSON</button>
</form>

@if (Model != null && Model.Count > 0)
{
    <form asp-controller="BulkImport" asp-action="Approve" method="post">
        <button class="btn btn-success mb-2" type="submit">Approve selected (Preview)</button>

        @foreach (var item in Model)
        {
            <div class="border p-2 mb-2">
                @if (item is Common.Models.Restaurant r)
                {
                    <input type="checkbox" name="itemIds" value="@r.Id" />
                }
                else if (item is Common.Models.MenuItem m)
                {
                    <input type="checkbox" name="itemIds" value="@m.Id" />
                }

                <div class="mt-2">
                    @await Html.PartialAsync(item.GetCardPartial(), item)
                </div>
            </div>
        }
    </form>

    <form asp-controller="BulkImport" asp-action="Commit" method="post" class="mt-3">
        <button class="btn btn-warning" type="submit">Commit to DB</button>
    </form>
}
else
{
    <div class="text-muted">No items yet. Upload a JSON file.</div>
}